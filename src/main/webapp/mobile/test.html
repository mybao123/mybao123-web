<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />   
	<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>拍照</title>
    <script src="scripts/jquery-1.11.1.min.js"></script>
     <script type="text/javascript">
 
        $(document).ready(init);
 
        function init() {
 
            //Google Chrome
            navigator.webkitGetUserMedia("video", success);  //初始化视频流
 
 
            //绑定拍照事件
            $("input[type='button']").click(function () {
                shoot(); //拍照方法
            });
        }
        function success(stream) {
 
            $("#myVideo").attr("src", window.webkitURL.createObjectURL(stream));
        }
        //拍照
        function shoot() {
 
            var video = $("#myVideo")[0];
            var canvas = capture(video);
 
 
            $("#result").empty();
            $("#result").append(canvas); //画布
            var imgData = canvas.toDataURL("image/jpg");
            var base64String = imgData.substr(22); //数据流
  
        }
 
        //初始化画布
        function capture(video) {
 
            var canvas = document.createElement('canvas');//创建画布
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            var ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);
            return canvas;
        }
    </script>
</head>
<body>
    <video id="myVideo" autoplay="autoplay"></video>
    <br />
    <input type="button" value="photo" /><br /> 
    <label>拍照结果</label>
    <div id="result">
    </div>
   
</body>
</html>
